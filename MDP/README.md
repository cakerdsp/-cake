# 强化学习迷宫问题求解

本项目实现了使用策略迭代和值迭代算法解决8x8迷宫问题的完整解决方案。

## 项目结构

```
强化学习/
├── maze_env.py              # 迷宫环境类
├── policy_iteration.py      # 策略迭代算法
├── value_iteration.py       # 值迭代算法
├── visualizer.py           # 可视化工具
├── main.py                 # 主程序
├── install_requirements.py # 依赖安装脚本
└── results/                # 结果输出目录
    ├── *.png               # 可视化图片
    ├── value_functions.txt # 值函数结果
    ├── policies.txt        # 策略结果
    ├── paths.txt          # 路径结果
    └── performance.txt    # 性能统计
```

## 环境设置

### 迷宫配置
- **大小**: 8x8网格
- **地图格式**: 二维数组存储
  - `0` = 路径
  - `1` = 墙壁  
  - `2` = 起始点
  - `3` = 目标点
- **默认起始位置**: (0,0) - 左上角
- **默认目标位置**: (7,7) - 右下角
- **奖励**: 每步-1，到达目标0

### 自定义地图
现在支持使用二维数组自定义地图：

```python
# 创建自定义地图
custom_map = np.array([
    [2, 0, 0, 0, 0, 0, 0, 0],  # 起始点在(0,0)
    [0, 1, 0, 0, 0, 0, 0, 0],  # 墙壁在(1,1)
    [0, 0, 0, 0, 0, 0, 0, 0],  # 全路径
    [0, 0, 0, 0, 0, 0, 0, 0],  # 全路径
    [0, 0, 0, 0, 0, 0, 0, 0],  # 全路径
    [0, 0, 0, 0, 0, 0, 0, 0],  # 全路径
    [0, 0, 0, 0, 0, 0, 0, 0],  # 全路径
    [0, 0, 0, 0, 0, 0, 0, 3]   # 目标点在(7,7)
])

# 使用自定义地图创建环境
env = MazeEnvironment(custom_map)

# 或者修改现有环境的地图
env.set_custom_map(custom_map)
```

### 算法参数
- **折扣因子 γ**: 0.9
- **收敛阈值 θ**: 1e-6
- **动作空间**: 北(N)、东(E)、南(S)、西(W)

## 运行方法

1. **安装依赖**:
```bash
python install_requirements.py
```

2. **运行主程序**:
```bash
python main.py
```

3. **运行自定义地图示例**:
```bash
python custom_map_example.py
```

## 功能特性

### 1. 迷宫环境 (maze_env.py)
- 8x8网格迷宫实现
- 墙壁、起始点、目标点定义
- 状态转移和奖励计算
- 迷宫可视化

### 2. 策略迭代 (policy_iteration.py)
- 策略评估：计算当前策略下的值函数
- 策略改进：基于值函数改进策略
- 迭代直到策略收敛
- 路径模拟和Q值计算

### 3. 值迭代 (value_iteration.py)
- 直接优化值函数
- 基于Bellman最优方程
- 收敛后提取最优策略
- 路径模拟和Q值计算

### 4. 可视化 (visualizer.py)
- 值函数热力图
- 策略箭头图
- 最优路径图
- 收敛过程图
- 算法比较图

### 5. 主程序 (main.py)
- 运行两种算法
- 性能比较
- 结果可视化
- 结果保存

## 输出结果

程序会生成以下结果：

1. **可视化图片**:
   - 迷宫环境图
   - 值函数热力图
   - 策略箭头图
   - 最优路径图
   - 收敛过程图
   - 算法比较图

2. **文本文件**:
   - 值函数详细数值
   - 策略详细动作
   - 最优路径步骤
   - 性能统计信息

3. **控制台输出**:
   - 算法执行过程
   - 性能比较
   - 路径分析

## 算法比较

程序会自动比较两种算法的：
- 计算时间
- 迭代次数
- 收敛速度
- 最终策略
- 最优路径
- 值函数差异

## 技术特点

- **模块化设计**: 每个算法独立实现
- **手动实现**: 不依赖现成的强化学习库
- **完整可视化**: 训练过程和结果的可视化
- **详细分析**: 全面的性能比较和分析
- **结果保存**: 所有结果自动保存到文件

## 实验报告

程序运行完成后，results/目录下的所有文件可用于生成实验报告，包括：
- MDP建模说明
- 算法实现细节
- 实验结果分析
- 性能比较
- 可视化结果
